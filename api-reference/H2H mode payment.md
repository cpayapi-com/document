# H2H mode payment

## Description

Payment without Payment Page for Credit card.

## Endpoint

*   REST API: **GET** `https://{api-host}/openapi/v2/pwpp`

## Parameters

| Name            | Type            | Mandatory     | Description   |
| :-------------- | :-------------- | :------------ | :-------------------------------------------------------------------------------------------- |
| merchantId      | int64       | yes       | unique id generated by cpay for partner|
| userId          | string      | yes       | unique user id generated by partner's system                                                 |
| merchantTradeNo | string      | yes       | unique order id generated by partner's system                                                |
| lang            | String	    | No        | Default English                                                                              |
| storeCc         | String      | No        | Specifies, if the credit card should be stored in case of success:<br/>0 = Do not store the card (default)<br/>1 = Store the card <br />In order to store the credit card,Credit Card Storage service should be enabled in your account. |
| ccStorageID     | String      | No        | When charging stored credit card, the ID of the stored card.                                 |
| firstName       | String      | yes       | First name on credit card                                                                    |
| lastName        | String      | yes       | Last name on credit card                                                                     |
| email           | String      | yes       |                                                                                              |
| iddCode         | String      | yes  |https://en.wikipedia.org/wiki/List_of_country_calling_codes<br/>Example:35                         |
| mobile          | String      | yes       | Example:712345678                                                                            |
| addressLine     | String      | Yes       | Alphanumeric, _ , -, . (1-50)                                                                |
| country         | String      | Yes       | ISO3166-1 2-digit country code                                                               |
| city            | String      | Yes       | Alphabetic (1-15)                                                                            |
| zip             | String      | Yes       | Billing zip code                                                                             |
| cardNumber      | String      | Yes       | Bank Card Number                                                                             |
| cvv             | String      | Yes       | CVV code                                                                                     |
| expDate         | String      | Yes       | Card expired Month / Card expired Year <br /> Example:  *12/27*                              |
| ip              | String      | Yes       | IPV4                                                                                         |
| document        | String      | No        | The document number represents the end user's national identification                        |
| currency        | String      | Yes       | ISO4217（only USD, EUR,GBP supported）                                                       |
| amount          | String      | Yes       | The precision is two decimal places,higher  precision rounds down.  <br />Example:  19.011 -> 19.01  1.528 -> 1.52 |
| products        | String      | No        | Merchant side order commodity JSON array.  <br />example：   "[{"name":"iphone 11","price":"5300.00","num":"2","currency":"CNY"},{"name":"macBook","price":"1234.00","num":"1","currency":"USD"}]" |
| payChannel      | String      | No        | Payment channel <br />example： payChannel1 or payChannel2                                   |
| clientHTTPAccept| String      | Yes       | request header that allows a characteristic string  <br /> example："text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,\*/\*;q=0.8,application/signed-exchange;v=b3;q=0.7" |
| clientHTTPUserAgent | String  | Yes       | ClientHTTPUserAgent<br />example： Mozilla/5.0 (iPhone; CPU  iPhone OS 11_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko)  Version/10.0 Mobile/14E304 Safari/602.1"                                          |
| callBackURL     | String      | No        | This callBackURL will be called back after the  order succeeds or fails, and the callBackURL configured in the order will be  used preferentially when calling back. If it is not in the order, the  callBackURL configured in the merchant platform will be used for callback                                                         |
| successURL      | String      | No        | Return to the merchant address after successful  payment                                     |
| failURL         | String      | No        | Return to merchant address after payment failure                                             |
| retURL          | String      | No        | 3D secure only, In cases where 553 isreturned.the  client should be redirected to bank'ssite.when the interaction with bank is  donethe client is redirected to this URL.                                                |
| createTime      | String      | Yes       | The Order time (ms) generated by merchant                                                     |
| sign            | String      | Yes       | see [algorithm](https://github.com/cpayapi-com/document/blob/main/api-reference/signature.md) |

> Note: This interface uses json to receive parameters


## Response

| Name             | Type   | Description                                                  |
| :----------------| :------| :------------------------------------------------------------ |
| code             | int64  | see [Error Code](https://github.com/cpayapi-com/document/blob/main/api-reference/error-code.md)     |
| msg              | string | description of `code`                                                                              |
| data.orderId     | string | This payment order id.<br/>After the jump, orderId will be spliced to successURL or failURL as a URL parameter:<br/><Your_SuccessURL>?txnRef=<orderId> |
| data.orderStatus | int    | The current status of the order                              |
| data.pageData    | string | HTML original document, jump to 3DS or successURL or failURL.<br/>You need open it or render it on your page. |
| data.redirectURL | string | The url that needs to be redirected                          |
| data.ccStorageID | string | When charging stored credit card, the ID of the stored card. |



## Example

```shell
curl --silent --location 'https://live.cpayapi.com/openapi/v2/pwpp' \
--header 'Content-Type: application/json' \
--data-raw '{
	"merchantId": <merchantId>,
	"userId": "<userId>",
	"amount": "<amount>",
	"createTime": "<createTime>",
	"currency": "<currency>",
	"ip": "<ip>",
	"merchantTradeNo": "<merchantTradeNo>",
	"firstName": "<firstName>",
	"lastName": "<lastName>",
	"email": "<email>",
	"iddCode": "<iddCode>",
	"mobile": "<mobile>",
	"addressLine": "<addressLine>",
	"country": "<country>",
	"city": "<city>",
	"document": "<document>",
	"cardNumber": "<cardNumber>",
	"cvv": "<cvv>",
	"expDate": "<expDate>",
	"zip": "<zip>",
	"payChannel": "<payChannel>",
	"callBackURL": "<callBackURL>",
	"successURL": "<successURL>",
	"failURL": "<failURL>",
	"clientHTTPAccept": "<clientHTTPAccept>",
	"clientHTTPUserAgent": "<clientHTTPUserAgent>",
	"retURL": "<retURL>",
	"sign": "<sign>"
}'
```

- successful example
```json
{
    "code": 0,
    "msg": "success",
    "data": {
        "orderId": "230531101816687178014",
        "orderStatus": 11,
        "pageData": "<!doctype html>xxxxxxxxxxxxxxxx</html>"
    },
    "traceid": "230531101816X6860094"
}
```
- error example
```json
{
    "code": 90751019,
    "msg": "create order fail: pay fail",
    "data": null,
    "traceid": "230531100629X9029613"
}
```

